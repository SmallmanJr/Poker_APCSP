import random
players = []
activePlayers = []
List_of_PlayersChips = []

Turn = "Dealer"
PlayerChipConvert = {}
PlayerNameConvert = {}
# --------------------------- #
class card:
    def __init__(self, Rank, Suit,):
        self.Rank = Rank
        self.Suit = Suit

    def __str__(self):
        return f'{self.rank} of {self.suit}'
class Deck:
    def __init__(self, ranks_parameter, suits_parameter):
        self.deck = []
        for rank in ranks_parameter:
            for suit in suits_parameter:
                self.deck.append(card(rank, suit))

    def length(self):
        cardNum = 0
        for i in self.deck:
            cardNum += 1
        return cardNum

    def shuffle(self):
        random.shuffle(self.deck)

    def deal(self):
        card_one = self.deck.pop()
        return card_one
class Hand:
    def __init__(self, Name):
        global players
        self.name = Name

        self.cards = []
        self.value = 0
        self.PokerKitStr = ""
        if Name != "River": 
            if Name is not None:
                players.append(self)
                activePlayers.append(self)
           
    def __str__(self):
        return f"{self.name}"
    
    def __repr__(self):
        return self.name

class Chips:
    def __init__(self, Name):
        self.total = 1000
        self.betamount = 0 
        self.name = Name
        List_of_PlayersChips.append(self)
        PlayerChipConvert[Name] = self
        PlayerNameConvert[Name] = self

        
    def __str__(self):
        return f'{self.name}'
        
    def __repr__(self):
        return self.name   
        
        
        
def AdvanceTurn():
    global Turn
    CurrentPlayers = []
    for p in activePlayers:
        CurrentPlayers.append(p.name)
    current_turn = CurrentPlayers.index(Turn)
    NextTurn = current_turn + 1
    if NextTurn > len(activePlayers)-1:
        NextTurn = 0
    NextPlayer = activePlayers[NextTurn]
    print(NextPlayer, "NextUser")
    Turn = NextPlayer
    
    
def Check_or_call(Userhand):
    otherBets = []
    if Userhand.name != "River" or "Dealer":
        global nameUser
        nameUser = str(Userhand)
        userChips = PlayerChipConvert.get(nameUser)
        
    for p in activePlayers:
        if p.name not in ["Dealer, Player", nameUser]:

            try:
                othername = str(p)
                OtherChips = PlayerChipConvert.get(othername)
                otherBets.append(OtherChips.betamount)
            except:
                pass
        elif p in ["Dealer, Player", nameUser]:
            print("member in rejected list")

            
    if otherBets:

        highestBet = max(otherBets)
        if userChips.betamount < highestBet:
            userChips.betamount = highestBet
            if userChips.betamount > userChips.total:
                userChips.betamount = userChips.total 
            print(userChips.betamount, userChips.name, "New Bet")
            
    
    AdvanceTurn()



def ManageMoney(Winner):   
    for player in players:
        print(player, "Now testing")
        try:
            tempchip = PlayerChipConvert[player.name]
            if player.name == Winner:
                tempchip.total -= tempchip.betamount
            if tempchip.total < 0:
                tempchip.total = 0
            else:
                tempchip.total = tempchip.betamount*2
            tempchips.betamount = 0 
            
            print(f"the new total {tempchips.total}, and the player bet is {tempchips.betamount}")
        except:
            print(f"{player.name} failed")




RiverHand = Hand("River")
DealerHand = Hand("Dealer")
PlayerHand = Hand("Player")
Bot1Hand = Hand("Bot1")
Bot2Hand = Hand("Bot2")
Bot3Hand = Hand("Bot3")

PlayerChips = Chips("Player")
bot1Chips = Chips('Bot1')
bot2Chips = Chips('Bot1')
bot3Chips = Chips('Bot1')
bot3Chips.betamount=1000
PlayerChips.betamount = 100
Check_or_call(PlayerHand)

winner= "Player"
ManageMoney(winner)
